{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _inherits from\"@babel/runtime/helpers/inherits\";import React,{Component}from'react';import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Text from\"react-native-web/dist/exports/Text\";import TextInput from\"react-native-web/dist/exports/TextInput\";import View from\"react-native-web/dist/exports/View\";import Button from\"react-native-web/dist/exports/Button\";import Alert from\"react-native-web/dist/exports/Alert\";import KeyboardAvoidingView from\"react-native-web/dist/exports/KeyboardAvoidingView\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import AsyncStorage from\"react-native-web/dist/exports/AsyncStorage\";import FlatList from\"react-native-web/dist/exports/FlatList\";import firebase from'firebase';import'firebase/firestore';import{SplashScreen}from'expo';import{ListItem}from'react-native-elements';var CompScreen=function(_React$Component){_inherits(CompScreen,_React$Component);function CompScreen(props){var _this;_classCallCheck(this,CompScreen);_this=_possibleConstructorReturn(this,_getPrototypeOf(CompScreen).call(this,props));_this.state={teams:[]};var name=_this.props.navigation.getParam('name','No Name');var sku=_this.props.navigation.getParam('sku','sku');console.log(sku);var fireStSn;AsyncStorage.getItem('team').then(function(team){_this.setState({team:team});fetch('https://api.vexdb.io/v1/get_teams?season=current&sku='+sku).then(function(response){return response.json();}).then(function(responseJson){var teams=responseJson[\"result\"];AsyncStorage.setItem('offlineTeamData-'+sku,JSON.stringify(teams));_this.setState({teams:teams});fireStSn=firebase.firestore().collection('teams').doc(team.replace(/\\D+/g,'')).collection('comp').doc(sku).collection('teams').onSnapshot(function(snapshot){var _loop=function _loop(teamItemNa){var teamItem=teams[teamItemNa];var has=false;snapshot.forEach(function(doc){if(doc.id==teamItem.number&&Object.keys(doc.data()).length>10){console.log(\"AHHH\");has=true;}});teams[teamItemNa].haveData=has;};for(var teamItemNa in teams){_loop(teamItemNa);}AsyncStorage.setItem('offlineTeamData'+sku,JSON.stringify(teams));_this.setState({teams:teams});});console.log(team+\"1\");fetch('https://api.vexdb.io/v1/get_matches?season=current&sku='+sku+'&team='+team).then(function(response){return response.json();}).then(function(responseJson){console.log(team+\"2\");var matches=responseJson[\"result\"];var allies=[];var opps=[];if(matches.length>0){for(var matchNa in matches){var matchItem=matches[matchNa];var ourTeamColor=void 0;var oppTeamColor=void 0;if(matchItem.red1==team||matchItem.red1==team||matchItem.red3==team){ourTeamColor=\"red\";oppTeamColor=\"blue\";}else if(matchItem.blue1==team||matchItem.blue2==team||matchItem.blue3==team){ourTeamColor=\"blue\";oppTeamColor=\"red\";}for(var i=1;i!=4;i++){if(matchItem[ourTeamColor+i]!=team)allies.push(matchItem[ourTeamColor+i]);}for(var i=1;i!=4;i++){opps.push(matchItem[oppTeamColor+i]);}}for(var teamItemNa in teams){var teamItem=teams[teamItemNa];var hasAlly=false;var hasOpp=false;for(var _iterator=allies,_isArray=Array.isArray(_iterator),_i=0,_iterator=_isArray?_iterator:_iterator[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++];}else{_i=_iterator.next();if(_i.done)break;_ref=_i.value;}var _ally=_ref;if(_ally==teamItem.number)hasAlly=true;}for(var _iterator2=opps,_isArray2=Array.isArray(_iterator2),_i2=0,_iterator2=_isArray2?_iterator2:_iterator2[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var _ref2;if(_isArray2){if(_i2>=_iterator2.length)break;_ref2=_iterator2[_i2++];}else{_i2=_iterator2.next();if(_i2.done)break;_ref2=_i2.value;}var _opp=_ref2;if(_opp==teamItem.number)hasOpp=true;}teams[teamItemNa].ally=hasAlly;teams[teamItemNa].opp=hasOpp;}AsyncStorage.setItem('offlineTeamData'+sku,JSON.stringify(teams));_this.setState({teams:teams});console.log(team+\"3\");}});});});AsyncStorage.getItem('offlineTeamData'+sku).then(function(offlineTeamData){if(offlineTeamData){console.log(\"\\n\\n\\n\\n\\nOFF\\n\\n\\n\\n\\n\");var teams=JSON.parse(offlineTeamData);_this.setState({teams:teams});fireStSn=firebase.firestore().collection('teams').doc(team.replace(/\\D+/g,'')).collection('comp').doc(sku).collection('teams').onSnapshot(function(snapshot){var _loop2=function _loop2(teamItemNa){var teamItem=teams[teamItemNa];var has=false;snapshot.forEach(function(doc){if(doc.id==teamItem.number&&Object.keys(doc.data()).length>10){console.log(\"AHHH\");has=true;}});teams[teamItemNa].haveData=has;};for(var teamItemNa in teams){_loop2(teamItemNa);}_this.setState({teams:teams});});}});return _this;}_createClass(CompScreen,[{key:\"render\",value:function render(){var _this2=this;return React.createElement(FlatList,{data:this.state.teams,renderItem:function renderItem(_ref3){var item=_ref3.item;return React.createElement(ListItem,{chevron:true,checkmark:item.haveData,onPress:function onPress(){return _this2.props.navigation.navigate('TeamInfo',{team:item.number,compName:_this2.props.navigation.getParam('compName'),sku:_this2.props.navigation.getParam('sku')});},bottomDivider:true,topDivider:true,subtitle:item.organisation+\" - \"+item.region,title:item.number,titleStyle:item.ally&&item.opp?{color:'purple',fontWeight:'bold'}:item.ally?{color:'green',fontWeight:'bold'}:item.opp?{color:'red',fontWeight:'bold'}:null});},keyExtractor:function keyExtractor(item){return item.id;},ListEmptyComponent:React.createElement(View,null,React.createElement(Text,null,\"No Competitions found for \",this.state.team))});}},{key:\"abbrState\",value:function abbrState(input,to){var states=[['Arizona','AZ'],['Alabama','AL'],['Alaska','AK'],['Arkansas','AR'],['California','CA'],['Colorado','CO'],['Connecticut','CT'],['Delaware','DE'],['Florida','FL'],['Georgia','GA'],['Hawaii','HI'],['Idaho','ID'],['Illinois','IL'],['Indiana','IN'],['Iowa','IA'],['Kansas','KS'],['Kentucky','KY'],['Louisiana','LA'],['Maine','ME'],['Maryland','MD'],['Massachusetts','MA'],['Michigan','MI'],['Minnesota','MN'],['Mississippi','MS'],['Missouri','MO'],['Montana','MT'],['Nebraska','NE'],['Nevada','NV'],['New Hampshire','NH'],['New Jersey','NJ'],['New Mexico','NM'],['New York','NY'],['North Carolina','NC'],['North Dakota','ND'],['Ohio','OH'],['Oklahoma','OK'],['Oregon','OR'],['Pennsylvania','PA'],['Rhode Island','RI'],['South Carolina','SC'],['South Dakota','SD'],['Tennessee','TN'],['Texas','TX'],['Utah','UT'],['Vermont','VT'],['Virginia','VA'],['Washington','WA'],['West Virginia','WV'],['Wisconsin','WI'],['Wyoming','WY']];if(to=='abbr'){input=input.replace(/\\w\\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase();});for(i=0;i<states.length;i++){if(states[i][0]==input){return states[i][1];}}}else if(to=='name'){input=input.toUpperCase();for(i=0;i<states.length;i++){if(states[i][1]==input){return states[i][0];}}}}}]);return CompScreen;}(React.Component);CompScreen.navigationOptions=function(_ref4){var navigation=_ref4.navigation;return{title:navigation.getParam('title','No Name').substring(0,25)+(\"\"+(navigation.getParam('title','No Name').substring(25).trim()!=\"\"?'...':''))};};export{CompScreen as default};var styles=StyleSheet.create({container:{flex:1,justifyContent:'center',alignItems:'center',backgroundColor:\"red\"},textInputBox:{borderBottomColor:\"white\",borderBottomWidth:1,marginBottom:40,width:\"90%\"},textInput:{alignSelf:'stretch',fontSize:24,height:40,fontWeight:'200',marginBottom:0,color:\"white\"},title:{fontSize:50,marginBottom:30,color:\"white\"},submitButton:{alignItems:'center',backgroundColor:\"blue\",width:\"90%\",padding:15,borderRadius:7,marginBottom:10}});","map":{"version":3,"sources":["C:/Users/karth/Documents/RoboticsScoutingTool/CompScreen.js"],"names":["React","Component","firebase","SplashScreen","ListItem","CompScreen","props","state","teams","name","navigation","getParam","sku","console","log","fireStSn","AsyncStorage","getItem","then","team","setState","fetch","response","json","responseJson","setItem","JSON","stringify","firestore","collection","doc","replace","onSnapshot","snapshot","teamItemNa","teamItem","has","forEach","id","number","Object","keys","data","length","haveData","matches","allies","opps","matchNa","matchItem","ourTeamColor","oppTeamColor","red1","red3","blue1","blue2","blue3","i","push","hasAlly","hasOpp","ally","opp","offlineTeamData","parse","item","navigate","compName","organisation","region","color","fontWeight","input","to","states","txt","charAt","toUpperCase","substr","toLowerCase","navigationOptions","title","substring","trim","styles","StyleSheet","create","container","flex","justifyContent","alignItems","backgroundColor","textInputBox","borderBottomColor","borderBottomWidth","marginBottom","width","textInput","alignSelf","fontSize","height","submitButton","padding","borderRadius"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { StyleSheet, Text, TextInput, View, Button, Alert, KeyboardAvoidingView, TouchableOpacity, AsyncStorage, FlatList} from 'react-native'\r\nimport firebase from 'firebase'\r\nimport 'firebase/firestore';\r\nimport { SplashScreen } from 'expo';\r\nimport { ListItem } from 'react-native-elements'\r\n\r\nexport default class CompScreen extends React.Component {\r\n\r\n      state = {\r\n        teams:[]\r\n      }\r\n    \r\n    constructor(props){\r\n      super(props)\r\n      let name = this.props.navigation.getParam('name', 'No Name')\r\n      let sku = this.props.navigation.getParam('sku','sku')\r\n      console.log(sku)\r\n      let fireStSn;\r\n        AsyncStorage.getItem('team').then((team)=>{\r\n            this.setState({team})\r\n            fetch('https://api.vexdb.io/v1/get_teams?season=current&sku='+sku)\r\n            .then((response) => response.json())\r\n            .then((responseJson)=>{\r\n                let teams = responseJson[\"result\"]\r\n                AsyncStorage.setItem('offlineTeamData-'+sku,JSON.stringify(teams))\r\n                this.setState({teams})            \r\n                fireStSn = firebase.firestore().collection('teams').doc(team.replace(/\\D+/g, '')).collection('comp').doc(sku).collection('teams').onSnapshot(snapshot => {\r\n                  for(let teamItemNa in teams){\r\n                    let teamItem = teams[teamItemNa]\r\n                    let has = false;\r\n                    snapshot.forEach(doc => {\r\n                        //console.log(doc.id, '=>', doc.data());\r\n                        if(doc.id == teamItem.number && Object.keys(doc.data()).length>10){\r\n                            console.log(\"AHHH\")\r\n                            has = true;\r\n                        }\r\n                    });\r\n                    teams[teamItemNa].haveData = has;\r\n                  }\r\n                  AsyncStorage.setItem('offlineTeamData'+sku,JSON.stringify(teams))\r\n                  this.setState({teams}) \r\n                })\r\n                console.log(team+\"1\")\r\n\r\n                fetch('https://api.vexdb.io/v1/get_matches?season=current&sku='+sku+'&team='+team)\r\n                .then((response) => response.json())\r\n                .then((responseJson)=>{\r\n                  console.log(team+\"2\")\r\n                    let matches = responseJson[\"result\"]\r\n                    let allies = []\r\n                    let opps = []\r\n                    if(matches.length>0){\r\n                        for(let matchNa in matches){\r\n                          let matchItem = matches[matchNa]\r\n                          let ourTeamColor;\r\n                          let oppTeamColor\r\n                          if(matchItem.red1==team||matchItem.red1==team||matchItem.red3==team){\r\n                            ourTeamColor = \"red\"\r\n                            oppTeamColor = \"blue\"\r\n                          }else if(matchItem.blue1==team||matchItem.blue2==team||matchItem.blue3==team){\r\n                            ourTeamColor = \"blue\"\r\n                            oppTeamColor = \"red\"\r\n                          }\r\n                          for(var i = 1; i!=4;i++){\r\n                            if(matchItem[ourTeamColor+i]!=team)\r\n                              allies.push(matchItem[ourTeamColor+i])\r\n                          }\r\n                          for(var i = 1; i!=4;i++){\r\n                              opps.push(matchItem[oppTeamColor+i])\r\n                          }\r\n                        }\r\n    \r\n                        for(let teamItemNa in teams){\r\n                          let teamItem = teams[teamItemNa]\r\n                          let hasAlly = false;\r\n                          let hasOpp = false;\r\n                          for(let ally of allies)\r\n                            if(ally == teamItem.number)\r\n                              hasAlly = true\r\n                          for(let opp of opps)\r\n                            if(opp == teamItem.number)\r\n                              hasOpp = true\r\n                          teams[teamItemNa].ally = hasAlly;\r\n                          teams[teamItemNa].opp = hasOpp;\r\n                        }\r\n    \r\n                        AsyncStorage.setItem('offlineTeamData'+sku,JSON.stringify(teams))\r\n                        this.setState({teams}) \r\n                        console.log(team+\"3\")\r\n                      }\r\n                    })\r\n                  })\r\n\r\n\r\n              })\r\n\r\n\r\n\r\n              AsyncStorage.getItem('offlineTeamData'+sku).then((offlineTeamData)=>{\r\n              \r\n                if(offlineTeamData){\r\n                  console.log(\"\\n\\n\\n\\n\\nOFF\\n\\n\\n\\n\\n\")\r\n                    let teams = JSON.parse(offlineTeamData)\r\n                    this.setState({teams})            \r\n                    fireStSn = firebase.firestore().collection('teams').doc(team.replace(/\\D+/g, '')).collection('comp').doc(sku).collection('teams').onSnapshot(snapshot => {\r\n                        for(let teamItemNa in teams){\r\n                            let teamItem = teams[teamItemNa]\r\n                            let has = false;\r\n                            snapshot.forEach(doc => {\r\n                                //console.log(doc.id, '=>', doc.data());\r\n                                if(doc.id == teamItem.number && Object.keys(doc.data()).length>10){\r\n                                    console.log(\"AHHH\")\r\n                                    has = true;\r\n                                }\r\n                            });\r\n                            teams[teamItemNa].haveData = has;\r\n                        }\r\n                        this.setState({teams}) \r\n                    })\r\n                   }\r\n  \r\n                  })            \r\n  \r\n      \r\n    }\r\n\r\n    static navigationOptions = ({ navigation }) => {\r\n        return {\r\n          title: navigation.getParam('title', 'No Name').substring(0,25)+`${navigation.getParam('title', 'No Name').substring(25).trim()!=\"\"?'...':''}`,\r\n        };\r\n      };\r\n   \r\n    render() {\r\n      return (\r\n        <FlatList\r\n            data={this.state.teams}\r\n            renderItem={({ item }) => <ListItem chevron checkmark={item.haveData} onPress={()=>this.props.navigation.navigate('TeamInfo',{team:item.number, compName: this.props.navigation.getParam('compName'),sku:this.props.navigation.getParam('sku')})}\r\n            bottomDivider topDivider subtitle={item.organisation+\" - \"+item.region} title={item.number} titleStyle={item.ally&&item.opp?{ color: 'purple', fontWeight: 'bold' }:item.ally?{ color: 'green', fontWeight: 'bold' }:item.opp?{ color: 'red', fontWeight: 'bold' }:null}/>}\r\n            keyExtractor={item => item.id}\r\n            ListEmptyComponent={<View><Text>No Competitions found for {this.state.team}</Text></View>}\r\n        />\r\n      )\r\n    }\r\n\r\n    abbrState(input, to){\r\n    \r\n        var states = [\r\n            ['Arizona', 'AZ'],\r\n            ['Alabama', 'AL'],\r\n            ['Alaska', 'AK'],\r\n            ['Arkansas', 'AR'],\r\n            ['California', 'CA'],\r\n            ['Colorado', 'CO'],\r\n            ['Connecticut', 'CT'],\r\n            ['Delaware', 'DE'],\r\n            ['Florida', 'FL'],\r\n            ['Georgia', 'GA'],\r\n            ['Hawaii', 'HI'],\r\n            ['Idaho', 'ID'],\r\n            ['Illinois', 'IL'],\r\n            ['Indiana', 'IN'],\r\n            ['Iowa', 'IA'],\r\n            ['Kansas', 'KS'],\r\n            ['Kentucky', 'KY'],\r\n            ['Louisiana', 'LA'],\r\n            ['Maine', 'ME'],\r\n            ['Maryland', 'MD'],\r\n            ['Massachusetts', 'MA'],\r\n            ['Michigan', 'MI'],\r\n            ['Minnesota', 'MN'],\r\n            ['Mississippi', 'MS'],\r\n            ['Missouri', 'MO'],\r\n            ['Montana', 'MT'],\r\n            ['Nebraska', 'NE'],\r\n            ['Nevada', 'NV'],\r\n            ['New Hampshire', 'NH'],\r\n            ['New Jersey', 'NJ'],\r\n            ['New Mexico', 'NM'],\r\n            ['New York', 'NY'],\r\n            ['North Carolina', 'NC'],\r\n            ['North Dakota', 'ND'],\r\n            ['Ohio', 'OH'],\r\n            ['Oklahoma', 'OK'],\r\n            ['Oregon', 'OR'],\r\n            ['Pennsylvania', 'PA'],\r\n            ['Rhode Island', 'RI'],\r\n            ['South Carolina', 'SC'],\r\n            ['South Dakota', 'SD'],\r\n            ['Tennessee', 'TN'],\r\n            ['Texas', 'TX'],\r\n            ['Utah', 'UT'],\r\n            ['Vermont', 'VT'],\r\n            ['Virginia', 'VA'],\r\n            ['Washington', 'WA'],\r\n            ['West Virginia', 'WV'],\r\n            ['Wisconsin', 'WI'],\r\n            ['Wyoming', 'WY'],\r\n        ];\r\n    \r\n        if (to == 'abbr'){\r\n            input = input.replace(/\\w\\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();});\r\n            for(i = 0; i < states.length; i++){\r\n                if(states[i][0] == input){\r\n                    return(states[i][1]);\r\n                }\r\n            }    \r\n        } else if (to == 'name'){\r\n            input = input.toUpperCase();\r\n            for(i = 0; i < states.length; i++){\r\n                if(states[i][1] == input){\r\n                    return(states[i][0]);\r\n                }\r\n            }    \r\n        }\r\n    }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor:\"red\",\r\n    \r\n  },\r\n  textInputBox: {\r\n    borderBottomColor:\"white\",\r\n    borderBottomWidth: 1,\r\n    marginBottom: 40,\r\n    width:\"90%\",\r\n  },\r\n  textInput: {\r\n    alignSelf: 'stretch',\r\n    fontSize: 24,\r\n    height: 40,\r\n    fontWeight: '200',\r\n    marginBottom: 0,\r\n    color:\"white\",\r\n    \r\n  },\r\n  title: {\r\n    fontSize:50,\r\n    marginBottom:30,\r\n    color:\"white\"\r\n  },\r\n  submitButton:{\r\n    alignItems: 'center',\r\n    backgroundColor:\"blue\",\r\n    width:\"90%\",\r\n    padding:15,\r\n    borderRadius:7,\r\n    marginBottom:10\r\n  },\r\n})"]},"metadata":{},"sourceType":"module"}